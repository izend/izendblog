<?php

/**
 *
 * @copyright  2010-2012 izend.org
 * @version    7
 * @link       http://www.izend.org
 */
?>
<?php
foreach ($contents as $c) {
	switch($c['type']) {
		case 'text':
			$s = $c['text'];
			if ($s) {
				echo $s, PHP_EOL;
			}
			break;
		case 'file':
			$file_content = $c['file'];
			if ($file_content) {
				echo '<div class="file">', PHP_EOL, $file_content, PHP_EOL,'</div>', PHP_EOL;
			}
			break;
		case 'download':
			$file = htmlspecialchars($c['file'], ENT_COMPAT, 'UTF-8');
			$download_url = $c['download_url'];
			echo '<div class="download">', PHP_EOL, '<a href="', $download_url, '" rel="nofollow">', $file, '</a>', PHP_EOL, '</div>', PHP_EOL;
			break;
		case 'infile':
			include $c['infile'];
			break;
		case 'longtail':
			extract($c);	/* file image width height skin icons controlbar duration autostart repeat */
			$id = uniqid('id');
			echo '<div class="longtail">', PHP_EOL;
			echo '<div id="', $id, '"></div>', PHP_EOL;
			echo '</div>', PHP_EOL;
			echo '<script type="text/javascript">', PHP_EOL;
			echo 'jwplayer("', $id, '").setup({', PHP_EOL;
			echo '    flashplayer: "', $base_path, '/longtail/player.swf",', PHP_EOL;
			echo '    id: "', $id, '",', PHP_EOL;
			echo '    width: ', $width, ',', PHP_EOL;
			echo '    height: ', $height, ',', PHP_EOL;
			if ($image) {
				echo '    image: "', $base_path, $image, '",', PHP_EOL;
			}
			$levels=preg_split('/[\s]+/', $file);
			switch (count($levels)) {
				case 1:
					echo '    file: "', $base_path, $file, '",', PHP_EOL;
					break;
				default:
					echo '    levels: [', PHP_EOL;
					foreach ($levels as $file) {
						echo '        { file: "', $base_path, $file, '" },', PHP_EOL;
					}
					echo '    ],', PHP_EOL;
					break;
			}
			if ($duration) {
				echo '    duration: "', $duration, '",', PHP_EOL;
			}
			if ($skin) {
				echo '    skin: "', $base_path, $skin, '",', PHP_EOL;
			}
			echo '    controlbar: "', $controlbar, '",', PHP_EOL;
			echo '    icons: "', $icons ? 'true' : 'false', '",', PHP_EOL;
			echo '    repeat: "', $repeat ? 'always' : 'none', '",', PHP_EOL;
			echo '    autostart: "', $autostart ? 'true' : 'false', '",', PHP_EOL;
			echo '    screencolor: "ffffff"', PHP_EOL;
			echo '});', PHP_EOL;
			echo '</script>', PHP_EOL;
			break;
		default:
			break;
	}
}
?>
